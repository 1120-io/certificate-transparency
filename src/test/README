You can do an end-to-end demo of the process of creating a server
certificate, sending it to the log server and getting back a log
proof, converting it to a proof certificate, serving the certificate
with Apache, and verifying the log proof.

To understand the various steps in detail, inspection of the Makefile
is suggested.

To compile the log server and client, follow the instructions in src/README.

To run a test SSL server, you will also need Apache. On Debian based
systems, running

$ sudo apt-get install apache2

should suffice. On other systems, you may also need to modify the
Makefile and/or the httpd.conf.

The steps for the end-to-end test are as follows:

1. Make platform dependent links:

$ make <platform>-links

e.g. "make linux-links"

2. Run the Log Server:

$ make run-server

Note that this does not detach, so...

3. From another window, generate the server certificate, get the log
proof, convert it to a proof certificate, and run Apache:

$ make run-apache

4. Test the proof

$ make connect

This should show something like:

../client/ct connect 127.0.0.1 8123 ct-server-key-public.pem
Reading cache...OK.
Connecting to 127.0.0.1:8123.
Proof extension found in certificate, verifying...OK.
Log proof verified.
WARNING. Certificate verification failed.
Connected.
Cached new checkpoint.
Writing cache...OK.


The certificate verification fails because the server certificate is
self-signed.

5. When done, stop Apache

$ make stop-apache

The second demo creates a leaf certificate with an embedded proof.

1. If the log server is not already running, do

$ make run-server

2. In another window, run Apache

$ make run-apache-embedded

This does the following steps:

a) Create a CA root certificate and issue a CA ProtoCert signing certificate.
b) Create a client Certificate Signing Request (CSR).
c) Sign the CSR with the CA ProtoCert signing key and submit the
signed request to the log server.
d) Retrieve a proof, embed it in the client certificate and sign the
certificate with the CA root key.
e) Run Apache with the resulting client certificate.

3. Connect to the server:

$ make connect-embedded

connects to the server. You should see this output:
Reading cache...OK.
Connecting to 127.0.0.1:8123.
Embedded proof extension found in certificate, verifying...OK.
Log proof verified.
WARNING. Certificate verification failed.
Connected.
Cached new checkpoint.
Writing cache...OK.

4. Stop apache:

$ make stop-apache-embedded



